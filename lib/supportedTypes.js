const { get } = require('lodash');
/*

  Refer to CloudFormation doc on resource properties
  https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html

  Considerations:
  - Some form of "Tags" property
    - watch out for uncommon property names such as "UserPoolTags"
  - Update requires: No interruption
  - format of tags (array vs map)
  - Some resources do not allow tag updates via CloudFormation (see AWS::WAFv2::RuleGroup)

*/

const SUPPORTED_TYPES_MAP_TAGS = [
  // Because these types take a json object of tags like
  /*
    {
      key1: 'value1',
      key2: 'value2',
    }
  */
  'AWS::ApiGatewayV2::Api',
  'AWS::ApiGatewayV2::DomainName',
  'AWS::ApiGatewayV2::Stage',
  'AWS::ApiGatewayV2::VpcLink',
  'AWS::Cognito::UserPool',
  'AWS::EKS::Nodegroup',
  'AWS::Glue::Crawler',
  'AWS::Glue::DevEndpoint',
  'AWS::Glue::Job',
  'AWS::Glue::MLTransform',
  'AWS::Glue::Trigger',
  'AWS::Glue::Workflow',
  'AWS::Greengrass::ConnectorDefinition',
  'AWS::Greengrass::CoreDefinition',
  'AWS::Greengrass::DeviceDefinition',
  'AWS::Greengrass::FunctionDefinition',
  'AWS::Greengrass::Group',
  'AWS::Greengrass::LoggerDefinition',
  'AWS::Greengrass::ResourceDefinition',
  'AWS::Greengrass::SubscriptionDefinition',
  'AWS::GreengrassV2::ComponentVersion',
  'AWS::GreengrassV2::Deployment',
  'AWS::ImageBuilder::DistributionConfiguration',
  'AWS::ImageBuilder::ImagePipeline',
  'AWS::ImageBuilder::InfrastructureConfiguration',
  'AWS::IoTTwinMaker::ComponentType',
  'AWS::IoTTwinMaker::Entity',
  'AWS::IoTTwinMaker::Scene',
  'AWS::IoTTwinMaker::Workspace',
  'AWS::M2::Application',
  'AWS::M2::Environment',
  'AWS::MWAA::Environment',
  'AWS::ResilienceHub::App',
  'AWS::ResilienceHub::ResiliencyPolicy',
  'AWS::RoboMaker::RobotApplication',
  'AWS::RoboMaker::SimulationApplication',
  'AWS::SecurityHub::Hub',
  'AWS::ServiceCatalogAppRegistry::Application',
  'AWS::ServiceCatalogAppRegistry::AttributeGroup',
  'AWS::SSM::Parameter',
];
const SUPPORTED_TYPES = [
  ...SUPPORTED_TYPES_MAP_TAGS,
  // plus traditional key-value array like
  /*
    [
      {
        Key: 'key1',
        Value: 'value1',
      },
      {
        Key: 'key2',
        Value: 'value2',
      },
    ]
  */
  'AWS::AccessAnalyzer::Analyzer',
  'AWS::AmazonMQ::Broker',
  'AWS::AmazonMQ::Configuration',
  'AWS::ApiGateway::ApiKey',
  'AWS::ApiGateway::ClientCertificate',
  'AWS::ApiGateway::DomainName',
  'AWS::ApiGateway::RestApi',
  'AWS::ApiGateway::Stage',
  'AWS::ApiGateway::UsagePlan',
  'AWS::ApiGateway::VpcLink',
  'AWS::ApplicationInsights::Application',
  'AWS::Cassandra::Keyspace',
  'AWS::Cassandra::Table',
  'AWS::CertificateManager::Certificate',
  'AWS::CloudFront::Distribution',
  'AWS::CloudFront::StreamingDistribution',
  'AWS::CloudTrail::EventDataStore',
  'AWS::CloudTrail::Trail',
  'AWS::CloudWatch::MetricStream',
  'AWS::CodeArtifact::Domain',
  'AWS::CodeArtifact::Repository',
  'AWS::CodeBuild::Project',
  'AWS::CodeBuild::ReportGroup',
  'AWS::CodeCommit::Repository',
  'AWS::CodeDeploy::Application',
  'AWS::CodeDeploy::DeploymentGroup',
  'AWS::CodeGuruProfiler::ProfilingGroup',
  'AWS::CodeGuruReviewer::RepositoryAssociation',
  'AWS::CodePipeline::CustomActionType',
  'AWS::CodePipeline::Pipeline',
  'AWS::CodeStarConnections::Connection',
  'AWS::Config::AggregationAuthorization',
  'AWS::Config::ConfigurationAggregator',
  'AWS::Config::StoredQuery',
  'AWS::Connect::ContactFlow',
  'AWS::Connect::ContactFlowModule',
  'AWS::Connect::HoursOfOperation',
  'AWS::Connect::PhoneNumber',
  'AWS::Connect::QuickConnect',
  'AWS::Connect::TaskTemplate',
  'AWS::Connect::User',
  'AWS::ConnectCampaigns::Campaign',
  'AWS::CustomerProfiles::Domain',
  'AWS::CustomerProfiles::Integration',
  'AWS::CustomerProfiles::ObjectType',
  'AWS::DynamoDB::Table',
  'AWS::EC2::CarrierGateway',
  'AWS::EC2::CustomerGateway',
  'AWS::EC2::DHCPOptions',
  'AWS::EC2::FlowLog',
  'AWS::EC2::Instance',
  'AWS::EC2::InternetGateway',
  'AWS::EC2::IPAM',
  'AWS::EC2::IPAMPool',
  'AWS::EC2::IPAMScope',
  'AWS::EC2::KeyPair',
  'AWS::EC2::LocalGatewayRouteTableVPCAssociation',
  'AWS::EC2::NatGateway',
  'AWS::EC2::NetworkAcl',
  'AWS::EC2::NetworkInsightsAccessScope',
  'AWS::EC2::NetworkInsightsAccessScopeAnalysis',
  'AWS::EC2::NetworkInsightsAnalysis',
  'AWS::EC2::NetworkInsightsPath',
  'AWS::EC2::NetworkInterface',
  'AWS::EC2::PrefixList',
  'AWS::EC2::RouteTable',
  'AWS::EC2::SecurityGroup',
  'AWS::EC2::Subnet',
  'AWS::EC2::TrafficMirrorFilter',
  'AWS::EC2::TrafficMirrorSession',
  'AWS::EC2::TrafficMirrorTarget',
  'AWS::EC2::TransitGateway',
  'AWS::EC2::TransitGatewayAttachment',
  'AWS::EC2::TransitGatewayConnect',
  'AWS::EC2::TransitGatewayMulticastDomain',
  'AWS::EC2::TransitGatewayPeeringAttachment',
  'AWS::EC2::TransitGatewayVpcAttachment',
  'AWS::EC2::Volume',
  'AWS::EC2::VPC',
  'AWS::EC2::VPCPeeringConnection',
  'AWS::EC2::VPNConnection',
  'AWS::EC2::VPNGateway',
  'AWS::ECR::PublicRepository',
  'AWS::ECR::Repository',
  'AWS::ECS::CapacityProvider',
  'AWS::ECS::Cluster',
  'AWS::ECS::Service',
  'AWS::ECS::TaskDefinition',
  'AWS::EKS::Addon',
  'AWS::EKS::FargateProfile',
  'AWS::EKS::IdentityProviderConfig',
  'AWS::ElastiCache::CacheCluster',
  'AWS::ElastiCache::ParameterGroup',
  'AWS::ElastiCache::ReplicationGroup',
  'AWS::ElastiCache::SecurityGroup',
  'AWS::ElastiCache::SubnetGroup',
  'AWS::ElasticBeanstalk::Environment',
  'AWS::ElasticLoadBalancing::LoadBalancer',
  'AWS::ElasticLoadBalancingV2::LoadBalancer',
  'AWS::ElasticLoadBalancingV2::TargetGroup',
  'AWS::Elasticsearch::Domain',
  'AWS::EMR::Cluster',
  'AWS::EMR::Studio',
  'AWS::EMRContainers::VirtualCluster',
  'AWS::EMRServerless::Application',
  'AWS::EventSchemas::Discoverer',
  'AWS::EventSchemas::Registry',
  'AWS::EventSchemas::Schema',
  'AWS::Evidently::Experiment',
  'AWS::Evidently::Feature',
  'AWS::Evidently::Launch',
  'AWS::Evidently::Project',
  'AWS::Evidently::Segment',
  'AWS::FMS::Policy',
  'AWS::Forecast::Dataset',
  'AWS::Forecast::DatasetGroup',
  'AWS::FraudDetector::Detector',
  'AWS::FraudDetector::EntityType',
  'AWS::FraudDetector::EventType',
  'AWS::FraudDetector::Label',
  'AWS::FraudDetector::Outcome',
  'AWS::FraudDetector::Variable',
  'AWS::FSx::FileSystem',
  'AWS::FSx::Snapshot',
  'AWS::FSx::StorageVirtualMachine',
  'AWS::FSx::Volume',
  'AWS::GameLift::GameServerGroup',
  'AWS::GameLift::GameSessionQueue',
  'AWS::GameLift::MatchmakingConfiguration',
  'AWS::GameLift::MatchmakingRuleSet',
  'AWS::GameLift::Script',
  'AWS::GlobalAccelerator::Accelerator',
  'AWS::Glue::Registry',
  'AWS::Glue::Schema',
  'AWS::GroundStation::Config',
  'AWS::GroundStation::DataflowEndpointGroup',
  'AWS::GroundStation::MissionProfile',
  'AWS::GuardDuty::Detector',
  'AWS::GuardDuty::Filter',
  'AWS::GuardDuty::IPSet',
  'AWS::HealthLake::FHIRDatastore',
  'AWS::IAM::OIDCProvider',
  'AWS::IAM::Role',
  'AWS::IAM::SAMLProvider',
  'AWS::IAM::ServerCertificate',
  'AWS::IAM::User',
  'AWS::IAM::VirtualMFADevice',
  'AWS::IoT::Authorizer',
  'AWS::IoT::CACertificate',
  'AWS::IoT::CustomMetric',
  'AWS::IoT::Dimension',
  'AWS::IoT::DomainConfiguration',
  'AWS::IoT::FleetMetric',
  'AWS::IoT::MitigationAction',
  'AWS::IoT::ProvisioningTemplate',
  'AWS::IoT::RoleAlias',
  'AWS::IoT::ScheduledAudit',
  'AWS::IoT::SecurityProfile',
  'AWS::IoT::TopicRule',
  'AWS::IoTAnalytics::Channel',
  'AWS::IoTAnalytics::Dataset',
  'AWS::IoTAnalytics::Datastore',
  'AWS::IoTAnalytics::Pipeline',
  'AWS::IoTCoreDeviceAdvisor::SuiteDefinition',
  'AWS::IoTEvents::AlarmModel',
  'AWS::IoTEvents::DetectorModel',
  'AWS::IoTEvents::Input',
  'AWS::IoTFleetHub::Application',
  'AWS::IoTFleetWise::Campaign',
  'AWS::IoTFleetWise::DecoderManifest',
  'AWS::IoTFleetWise::Fleet',
  'AWS::IoTFleetWise::ModelManifest',
  'AWS::IoTFleetWise::SignalCatalog',
  'AWS::IoTFleetWise::Vehicle',
  'AWS::IoTSiteWise::Asset',
  'AWS::IoTSiteWise::AssetModel',
  'AWS::IoTSiteWise::Dashboard',
  'AWS::IoTSiteWise::Gateway',
  'AWS::IoTSiteWise::Portal',
  'AWS::IoTSiteWise::Project',
  'AWS::IoTWireless::Destination',
  'AWS::IoTWireless::DeviceProfile',
  'AWS::IoTWireless::FuotaTask',
  'AWS::IoTWireless::MulticastGroup',
  'AWS::IoTWireless::PartnerAccount',
  'AWS::IoTWireless::ServiceProfile',
  'AWS::IoTWireless::TaskDefinition',
  'AWS::IoTWireless::WirelessDevice',
  'AWS::IoTWireless::WirelessGateway',
  'AWS::IVS::Channel',
  'AWS::IVS::PlaybackKeyPair',
  'AWS::IVS::RecordingConfiguration',
  'AWS::IVS::StreamKey',
  'AWS::Kendra::DataSource',
  'AWS::Kendra::Faq',
  'AWS::Kendra::Index',
  'AWS::Kinesis::Stream',
  'AWS::KinesisAnalyticsV2::Application',
  'AWS::KinesisFirehose::DeliveryStream',
  'AWS::KinesisVideo::SignalingChannel',
  'AWS::KinesisVideo::Stream',
  'AWS::Lambda::Function',
  'AWS::Lex::Bot',
  'AWS::Lex::BotAlias',
  'AWS::Lightsail::Bucket',
  'AWS::Lightsail::Certificate',
  'AWS::Lightsail::Container',
  'AWS::Lightsail::Database',
  'AWS::Lightsail::Disk',
  'AWS::Lightsail::Distribution',
  'AWS::Lightsail::Instance',
  'AWS::Lightsail::LoadBalancer',
  'AWS::Logs::LogGroup',
  'AWS::LookoutEquipment::InferenceScheduler',
  'AWS::Macie::AllowList',
  'AWS::MediaConvert::JobTemplate',
  'AWS::MediaConvert::Preset',
  'AWS::MediaConvert::Queue',
  'AWS::MediaPackage::Asset',
  'AWS::MediaPackage::Channel',
  'AWS::MediaPackage::OriginEndpoint',
  'AWS::MediaPackage::PackagingConfiguration',
  'AWS::MediaPackage::PackagingGroup',
  'AWS::MediaStore::Container',
  'AWS::MediaTailor::PlaybackConfiguration',
  'AWS::MemoryDB::ACL',
  'AWS::MemoryDB::Cluster',
  'AWS::MemoryDB::ParameterGroup',
  'AWS::MemoryDB::SubnetGroup',
  'AWS::MemoryDB::User',
  'AWS::Neptune::DBCluster',
  'AWS::Neptune::DBClusterParameterGroup',
  'AWS::Neptune::DBSubnetGroup',
  'AWS::NetworkFirewall::Firewall',
  'AWS::NetworkFirewall::FirewallPolicy',
  'AWS::NetworkFirewall::RuleGroup',
  'AWS::NetworkManager::ConnectAttachment',
  'AWS::NetworkManager::ConnectPeer',
  'AWS::NetworkManager::CoreNetwork',
  'AWS::NetworkManager::Device',
  'AWS::NetworkManager::GlobalNetwork',
  'AWS::NetworkManager::Link',
  'AWS::NetworkManager::Site',
  'AWS::NetworkManager::SiteToSiteVpnAttachment',
  'AWS::NetworkManager::VpcAttachment',
  'AWS::OpenSearchService::Domain',
  'AWS::OpsWorks::Layer',
  'AWS::OpsWorks::Stack',
  'AWS::OpsWorksCM::Server',
  'AWS::Panorama::ApplicationInstance',
  'AWS::Panorama::Package',
  'AWS::Pinpoint::App',
  'AWS::Pinpoint::Campaign',
  'AWS::Pinpoint::EmailTemplate',
  'AWS::Pinpoint::InAppTemplate',
  'AWS::Pinpoint::PushTemplate',
  'AWS::Pinpoint::Segment',
  'AWS::Pinpoint::SmsTemplate',
  'AWS::PinpointEmail::ConfigurationSet',
  'AWS::PinpointEmail::DedicatedIpPool',
  'AWS::PinpointEmail::Identity',
  'AWS::QLDB::Ledger',
  'AWS::QLDB::Stream',
  'AWS::QuickSight::Analysis',
  'AWS::QuickSight::Dashboard',
  'AWS::QuickSight::DataSet',
  'AWS::QuickSight::DataSource',
  'AWS::QuickSight::Template',
  'AWS::QuickSight::Theme',
  'AWS::RAM::ResourceShare',
  'AWS::RDS::DBCluster',
  'AWS::RDS::DBClusterParameterGroup',
  'AWS::RDS::DBInstance',
  'AWS::RDS::DBParameterGroup',
  'AWS::RDS::DBProxy',
  'AWS::RDS::DBProxyEndpoint',
  'AWS::RDS::DBSecurityGroup',
  'AWS::RDS::DBSubnetGroup',
  'AWS::RDS::EventSubscription',
  'AWS::RDS::OptionGroup',
  'AWS::Redshift::Cluster',
  'AWS::Redshift::ClusterParameterGroup',
  'AWS::Redshift::ClusterSecurityGroup',
  'AWS::Redshift::ClusterSubnetGroup',
  'AWS::Redshift::EventSubscription',
  'AWS::RedshiftServerless::Workgroup',
  'AWS::RefactorSpaces::Application',
  'AWS::RefactorSpaces::Environment',
  'AWS::RefactorSpaces::Route',
  'AWS::RefactorSpaces::Service',
  'AWS::Rekognition::Collection',
  'AWS::Rekognition::StreamProcessor',
  'AWS::ResourceGroups::Group',
  'AWS::RolesAnywhere::CRL',
  'AWS::RolesAnywhere::Profile',
  'AWS::RolesAnywhere::TrustAnchor',
  'AWS::Route53RecoveryReadiness::Cell',
  'AWS::Route53RecoveryReadiness::ReadinessCheck',
  'AWS::Route53RecoveryReadiness::RecoveryGroup',
  'AWS::Route53RecoveryReadiness::ResourceSet',
  'AWS::Route53Resolver::FirewallDomainList',
  'AWS::Route53Resolver::FirewallRuleGroup',
  'AWS::Route53Resolver::FirewallRuleGroupAssociation',
  'AWS::Route53Resolver::ResolverEndpoint',
  'AWS::Route53Resolver::ResolverRule',
  'AWS::RUM::AppMonitor',
  'AWS::S3::Bucket',
  'AWS::S3::StorageLens',
  'AWS::S3Outposts::Bucket',
  'AWS::SageMaker::CodeRepository',
  'AWS::SageMaker::Device',
  'AWS::SageMaker::DeviceFleet',
  'AWS::SageMaker::Endpoint',
  'AWS::SageMaker::EndpointConfig',
  'AWS::SageMaker::Image',
  'AWS::SageMaker::Model',
  'AWS::SageMaker::ModelPackage',
  'AWS::SageMaker::ModelPackageGroup',
  'AWS::SageMaker::MonitoringSchedule',
  'AWS::SageMaker::NotebookInstance',
  'AWS::SageMaker::Pipeline',
  'AWS::SageMaker::Workteam',
  'AWS::SecretsManager::Secret',
  'AWS::ServiceCatalog::CloudFormationProduct',
  'AWS::ServiceCatalog::CloudFormationProvisionedProduct',
  'AWS::SES::ContactList',
  'AWS::Signer::SigningProfile',
  'AWS::SNS::Topic',
  'AWS::SQS::Queue',
  'AWS::SSM::Document',
  'AWS::SSM::MaintenanceWindow',
  'AWS::SSM::PatchBaseline',
  'AWS::SSMIncidents::ResponsePlan',
  'AWS::SSO::PermissionSet',
  'AWS::StepFunctions::Activity',
  'AWS::StepFunctions::StateMachine',
  'AWS::Synthetics::Canary',
  'AWS::Synthetics::Group',
  'AWS::Timestream::Database',
  'AWS::Timestream::ScheduledQuery',
  'AWS::Timestream::Table',
  'AWS::Transfer::Agreement',
  'AWS::Transfer::Certificate',
  'AWS::Transfer::Connector',
  'AWS::Transfer::Profile',
  'AWS::Transfer::Server',
  'AWS::Transfer::User',
  'AWS::Transfer::Workflow',
  'AWS::VoiceID::Domain',
  'AWS::WorkSpaces::Workspace',
  'AWS::XRay::Group',
  'AWS::XRay::SamplingRule',
];

const getTypeTagKey = (resourceType) => {
  const typeMap = {
    'AWS::Cognito::UserPool': 'UserPoolTags',
    'AWS::Lex::Bot': 'BotTags',
    'AWS::Lex::BotAlias': 'BotAliasTags',
  };

  return get(typeMap, resourceType, 'Tags');
};

module.exports = {
  SUPPORTED_TYPES_MAP_TAGS,
  SUPPORTED_TYPES,
  getTypeTagKey,
};
